---js
{
  layout: "base.njk",
  title: "Morning Briefings",
  eleventyComputed: {
    headerDate: (data) => {
      const briefings = data.collections.briefings;
      if (briefings && briefings.length > 0) {
        const date = new Date(briefings[0].fileSlug + "T12:00:00");
        return date.toLocaleDateString("en-US", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric"
        });
      }
      return null;
    }
  }
}
---

{% set latestBriefing = collections.briefings | first %}

{% if latestBriefing %}
<article class="featured-briefing">
  <div class="featured-content">
    {{ latestBriefing.content | stripFirstH1 | safe }}
  </div>
</article>
{% endif %}

{% set olderBriefings = collections.briefings | slice(1) %}

{% if olderBriefings.length > 0 %}
<section class="archive-section">
  <header class="archive-header">
    <span class="archive-title">Archive</span>
    <span class="archive-rule"></span>
  </header>
  {% set months = olderBriefings | groupByMonth %}
  {% for month in months %}
  <details class="archive-month"{{ " open" if loop.first }}>
    <summary class="archive-month-label">{{ month.label }}</summary>
    {% set weeks = month.items | groupByWeek %}
    {% for week in weeks %}
    <details class="archive-week"{{ " open" if loop.first }}>
      <summary class="archive-week-label">{{ week.label }}</summary>
      <ul class="archive-list">
        {% for brief in week.items %}
        <li>
          <a href="{{ brief.url }}">
            <time datetime="{{ brief.fileSlug }}">{{ brief.fileSlug | readableDate }}</time>
          </a>
        </li>
        {% endfor %}
      </ul>
    </details>
    {% endfor %}
  </details>
  {% endfor %}
</section>
{% endif %}

{% if collections.briefings.length == 0 %}
<p class="empty-state">No briefings yet. Check back tomorrow.</p>
{% endif %}
